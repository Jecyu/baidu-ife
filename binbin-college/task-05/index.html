<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>任务五：基础JavaScript练习（二）</title>
    <style>

        ul, li {
            list-style: none;
            margin: 0;
            padding: 0;
        }

        ul {
            height: 500px;

            /*background: #3b3b3b;*/
            /*overflow: hidden;*/
        }

        li {
            /*float: left;*/
            display: inline-block;
            vertical-align: bottom;
            margin-top: 10px;
            margin-right: 10px;
            padding: 10px;

            color: #fff;
            background: #ff3f41;
            cursor: pointer;
        }
    </style>
</head>
<body>
<div>
    <input id="num-input" type="text" placeholder="请输入一个10-100之间的数字">
    <button id="left-into-btn">左侧入</button>
    <button id="right-into-btn">右侧入</button>
    <button id="left-out-btn">左侧出</button>
    <button id="right-out-btn">右侧出</button>
    <!--<button id="sort">从大到小排序</button>-->
    <button id="sort">从小到大排序</button>
    <ul id="queue"></ul>
</div>
<script>
    // 解题思路：
    // 1.限制输入的数字在10-100   10 <= num && num <= 100
    // 2.队列展现方式直接用高度表示数字大小 ： 通过把数值赋予height,单位为百分比，动态设置li的高度样式
    // 3.队列元素数量最多限制为60个，当超过60个时，添加元素时alert出提示     if(lis.length > 60)置于插入的地方或
    // 调用插入的地方
    // 4.对队列元素的值进行排序，冒泡排序后可视化打印出来 插入排序 把

    /**
     * isLegal
     * 验证输入的数值是否合乎规范、要求
     * @param [Number] 用户传入的值
     * @return [Boolean] 返回ture或false
     */
    function isLegal(num) {
        if (isNaN(num) || !(10 <= num && num <= 100)) {
            alert("请输入一个10-100之间的数字");
            return false;
        } else if (num === '' || num === null) {
            alert("不能为空");
            return false;
        } else {
            return true;
        }
    }

    /**
     * insertToLeft
     * 把输入的数字插入到队列的左边
     * @param [Number] num 用户输入的数字
     */
    function insertFromLeft(num) {
        var li = document.createElement('li');
        li.innerHTML = +num;
        // 转为为数字
        // num = +num;
        // 无论是num为10还是"10"，结果均为"10%"
        li.style.height = num + '%';
        // console.log(typeof num);
        li.addEventListener('click', function () {
            this.parentNode.removeChild(this);
        });
        // 定位父节点
        var ul = document.querySelector('#queue');
        // 插入到头部
        ul.insertBefore(li, ul.firstChild);
    }

    /**
     * insertToLeft
     * 把输入的数字插入到队列的右边
     * @param [Number] num 用户输入的数字
     */
    function insertFromRight(num) {
        var li = document.createElement('li');
        // 转为数字
        li.innerHTML = +num;
        li.style.height = num + '%';
        // 给li标签绑定单击清除事件
        li.addEventListener('click', function () {
            this.parentNode.removeChild(this);
        });
        // 定位父节点
        var ul = document.querySelector('#queue');
        // 插入到尾部
        ul.insertBefore(li, null);

    }

    /**
     * deleteFormLeft
     * 移除第一个元素
     */
    function deleteFromLeft() {
        var lis = document.querySelectorAll('li');
        // 获取要删除的元素的值
        var value = lis[0].innerHTML;
        // message存储确认confirm消息对话框的返回值
        if (value === undefined) {
            alert("请输入一个10-100之间的数字并点击插入");
        }
        else {
            var message = confirm('是否删除该元素：' + value + '?');
            if (message) {
                lis[0].remove();
            }
        }
    }

    /**
     * deleteFormRight
     * 移除最后一个元素
     */
    function deleteFromRight() {
        var lis = document.querySelectorAll('li');
        // 获取要删除的元素的值
        var value = lis[0].innerHTML;
        var message = confirm('是否删除该元素：' + value + '?');
        if (value === undefined) {
            alert("请输入一个数字并点击插入");
        }
        else {
            if (message) {
                lis[lis.length - 1].remove();
            }
        }
    }


    function bubbleSort(numlist) {
        for(var i = 0, len = numlist.length-1; i < len; i++) {
            for(var j = 0 ,len = numlist.length-1; j < len; j++) {
                if(numlist[j].innerHTML > numlist[j+1].innerHTML) {
                    var tmp1 = numlist[j+1].innerHTML;
                    numlist[j+1].innerHTML= numlist[j].innerHTML;
                    numlist[j].innerHTML = tmp1;

                    // 高度也要排序
                    var tmp2 = numlist[j+1].style.height;
                    numlist[j+1].style.height= numlist[j].style.height;
                    numlist[j].style.height = tmp2;
                }
            }
        }

        return numlist;
    }

    /**
     * init
     * 给插入、删除等按钮绑定点击事件，触发插入、删除操作
     */
    function init() {
        var leftIntoBtn = document.getElementById('left-into-btn');
        var rightIntoBtn = document.getElementById('right-into-btn');
        var leftOutBtn = document.getElementById('left-out-btn');
        var rightOutBtn = document.getElementById('right-out-btn');
        var sortBtn = document.getElementById('sort');
        var numInput = document.getElementById('num-input');
        var ul = document.querySelector('#queue');

        // 绑定点击事件
        leftIntoBtn.addEventListener('click', function () {
            // 先找到input框，再使用它的值value
            // 输入合法则插入
            if(ul.childNodes.length > 60) {
                alert("不能继续插入，队列元素最多为60个");
            }
            if (isLegal(numInput.value) && ul.childNodes.length <= 60) {
                insertFromLeft(numInput.value);
            }
            // 清空输入框，并获得焦点
            numInput.value = '';
            numInput.focus();
        });

        rightIntoBtn.addEventListener('click', function () {
            if(ul.childNodes.length > 60) {
                alert("不能继续插入，队列元素最多为60个");
            }
            if (isLegal(numInput.value ) && ul.childNodes.length <= 60) {
                insertFromRight(numInput.value);
            }
            numInput.value = '';
            numInput.focus();
        });

        leftOutBtn.addEventListener('click', function () {
            deleteFromLeft(numInput.value);
            numInput.value = '';
            numInput.focus();

        });

        rightOutBtn.addEventListener('click', function () {
            deleteFromRight(numInput.value);
            numInput.value = '';
            numInput.focus();
        });

        sortBtn.addEventListener('click', function () {
            // 进行排序
            ul.childNodes = bubbleSort(ul.childNodes);
            // console.log(ul.childNodes);
        });

    }

    init();

</script>
</body>
</html>

